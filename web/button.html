<script src="https://cdn.netpie.io/microgear.js"></script>

<script>

const APPID = "random0";
const KEY = "OBWwsgWlYGrU3vB";
const SECRET = "AlC9DrSyTastaEW6CuqwB90kN";

const ALIAS = "DigitalOUTPUT_HTML_web";     //  ชื่อตัวเอง
const thing1 = "NodeMCU1";


  function switchPress(logic){
    if(logic == 1 ){
      microgear.chat(thing1,"ON");
    }else if(logic == 0 ){
      microgear.chat(thing1,"OFF");
    }
  }

  var microgear = Microgear.create({
    key: KEY,
    secret: SECRET,
    alias : ALIAS
  });


  microgear.on('message', function(topic,data) {
    console.log(data);
    var packet = data.toString();
    var data = packet.split("/");
    console.log(data);
    document.getElementById("x").innerHTML = "x = ".concat(data[0]);
    document.getElementById("y").innerHTML = "y = ".concat(data[1]);
    document.getElementById("z").innerHTML = "z = ".concat(data[2]);
    document.getElementById("avg").innerHTML = "avg = ".concat(data[3]);
    document.getElementById("status").innerHTML = "status = ".concat(data[4]);
  });

  microgear.on('connected', function() {
    microgear.setAlias(ALIAS);
    document.getElementById("connected_NETPIE").innerHTML = "Connected to NETPIE"
  });

  microgear.on('present', function(event) {
    console.log(event);
  });

  microgear.on('absent', function(event) {
    console.log(event);
  });

  microgear.resettoken(function(err) {
    microgear.connect(APPID);
  });

</script>
<body class="container">
  <center>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
    <div class="alert alert-dark" role="alert">
      <h1>DETECTION ALARM</h1>
      <h1 id="connected_NETPIE" hidden>DETECTION ALARM</h1>
      <button type="button" class="btn btn-danger" onclick="switchPress(0)">STOP ALARM</button>
    </div>
    <!-- <button type="button" onclick="switchPress(1)">Turn ON</button> -->

    <div class="alert alert-primary" role="alert">
      <h1 id="x">x</h1>
    </div>
    <div class="alert alert-success" role="alert">
      <h1 id="y">y</h1>
    </div>
    <div class="alert alert-info" role="alert">
      <h1 id="z">z</h1>
    </div>
    <div class="alert alert-secondary" role="alert">
      <h1 id="avg">avg</h1>
    </div>
    <div class="alert alert-dark" role="alert">
      <h1 id="status">status</h1>
    </div>

  </center>
</body>
